{"version":3,"file":"../photo-tag.js","sources":["photo-tag.js"],"sourcesContent":["\"use strict\";\n/// <reference types=\"jquery\" />\n/// <reference path=\"../types/jquery/index.d.ts\"/>\n/// <reference path=\"./browser.d.ts\"/>\n/// <reference path=\"./util.ts\"/>\n$(function () {\n    var emptyTag = '-';\n    var css = 'selected';\n    var $status = $('#status');\n    var $letters = $('#letters');\n    var $selectors = $('#selectors');\n    var $thumbs = $('#thumbs');\n    var id = 'item-' + selectedTag.substr(0, 1).toLowerCase();\n    /** Tag selection list for current letter */\n    var $selector = $selectors.find('#' + id);\n    /** Currently selected letter */\n    var $li = $letters.find('li[data-for=' + id + ']');\n    $selector.val(selectedTag).show();\n    $li.addClass(css);\n    loadPhotoTag(selectedTag);\n    $letters.find('li').click(function () {\n        $li.removeClass(css);\n        $li = $(this);\n        $li.addClass(css);\n        $selector.val(emptyTag);\n        $selector.hide();\n        $selector = $('#' + $li.data('for'));\n        $selector.show();\n        var $options = $selector.find('option');\n        if ($options.length == 2) {\n            var tag = $options[1].value;\n            $selector.val(tag);\n            loadPhotoTag(tag);\n        }\n        else {\n            $thumbs.empty();\n            $status.html('Waiting for selection &hellip;');\n        }\n    });\n    $selectors.on('change', 'select', function (e) {\n        e.stopPropagation();\n        e.preventDefault();\n        var tag = $selector.val();\n        loadPhotoTag(tag);\n        if (tag && tag != emptyTag) {\n            window.history.pushState(null, siteName + \" photos tagged with \\\"\" + tag + \"\\\"\", \"/photo-tag/\" + tag);\n        }\n    });\n    /**\n     * Load photo-search.hbs rendered by server.\n     */\n    function loadPhotoTag(tag) {\n        if (tag && tag != emptyTag) {\n            var url = \"/photo-tag/search/\" + tag;\n            $status.html('Retrieving images &hellip;');\n            $thumbs.load(url, function (_response, status) {\n                $status.empty();\n                if (status === 'error') {\n                    $thumbs.empty();\n                    alert(\"Sorry about that. Looking for \\\"\" + tag + \"\\\" photos caused an error.\");\n                }\n                window.scrollTo(0, 0);\n            });\n        }\n        else {\n            $thumbs.empty();\n            $status.empty();\n        }\n    }\n});\n"],"names":["$","css","$status","$letters","$selectors","$thumbs","id","selectedTag","substr","toLowerCase","$selector","find","$li","loadPhotoTag","tag","url","html","load","_response","status","empty","alert","window","scrollTo","val","show","addClass","click","removeClass","this","hide","data","$options","length","value","on","e","stopPropagation","preventDefault","history","pushState","siteName"],"mappings":"AAAA,aAKAA,EAAE,WACE,IACIC,EAAM,WACNC,EAAUF,EAAE,WACZG,EAAWH,EAAE,YACbI,EAAaJ,EAAE,cACfK,EAAUL,EAAE,WACZM,EAAK,QAAUC,YAAYC,OAAO,EAAG,GAAGC,cAExCC,EAAYN,EAAWO,KAAK,IAAML,GAElCM,EAAMT,EAASQ,KAAK,eAAiBL,EAAK,KAmC9C,SAASO,EAAaC,GAClB,GAAIA,GA9CO,KA8CAA,EAAiB,CACxB,IAAIC,EAAM,qBAAuBD,EACjCZ,EAAQc,KAAK,8BACbX,EAAQY,KAAKF,EAAK,SAAUG,EAAWC,GACnCjB,EAAQkB,QACO,UAAXD,IACAd,EAAQe,QACRC,MAAM,kCAAqCP,EAAM,8BAErDQ,OAAOC,SAAS,EAAG,UAIvBlB,EAAQe,QACRlB,EAAQkB,QAjDhBV,EAAUc,IAAIjB,aAAakB,OAC3Bb,EAAIc,SAASzB,GACbY,EAAaN,aACbJ,EAASQ,KAAK,MAAMgB,MAAM,WACtBf,EAAIgB,YAAY3B,IAChBW,EAAMZ,EAAE6B,OACJH,SAASzB,GACbS,EAAUc,IAlBC,KAmBXd,EAAUoB,QACVpB,EAAYV,EAAE,IAAMY,EAAImB,KAAK,SACnBN,OACV,IAAIO,EAAWtB,EAAUC,KAAK,UAC9B,GAAuB,GAAnBqB,EAASC,OAAa,CACtB,IAAInB,EAAMkB,EAAS,GAAGE,MACtBxB,EAAUc,IAAIV,GACdD,EAAaC,QAGbT,EAAQe,QACRlB,EAAQc,KAAK,oCAGrBZ,EAAW+B,GAAG,SAAU,SAAU,SAAUC,GACxCA,EAAEC,kBACFD,EAAEE,iBACF,IAAIxB,EAAMJ,EAAUc,MACpBX,EAAaC,GACTA,GAtCO,KAsCAA,GACPQ,OAAOiB,QAAQC,UAAU,KAAMC,SAAW,wBAA2B3B,EAAM,IAAM,cAAgBA"}